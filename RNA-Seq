#this is to document setting up the process
# Activate your environment
conda activate bioinfo

# Make two directories: work then inside that make golden
mkdir -p work/golden

# Switch to the directory
cd work/golden
# Download the reference genome.
wget -nc http://data.biostarhandbook.com/books/rnaseq/data/golden.genome.tar.gz

# Unpack the reference genome.
tar xzvf golden.genome.tar.gz

# list the contents of the reference file called ref
ls -l refs/

# evaluate the file
seqkit stats refs/*.fa
# the above means The genome has a single chromosome of size of 128,765 bp. There are 92 transcripts. The shortest transcript is 273bp. The longest is 2022bp. The total transcript size is 92 x 899 = 82,708 basepairs.

# what the genome file looks like. the result is The genome is a FASTA file, the chromosomal sequence is named Golden
cat refs/genome.fa | head -5

# what is the annotation file
cat refs/features.gff | head -5

# how mant exons are there
cat refs/features.gff | grep exon | wc -l

# What do the transcripts look like
cat refs/transcripts.fa | head -5

To see the golden snidget naming schemes, Print out more gene names.
cat refs/transcripts.fa | grep ">" | head

## to align a sample against a reference - if you are not sure if they will line up
# The index to the genome
IDX=refs/genome.fa

# Build the index
hisat2-build $IDX $IDX

# Create the transcript alignment BAM file.
hisat2 -x $IDX -f -U refs/transcripts.fa | samtools sort > refs/transcripts.bam

# Index the BAM file
samtools index refs/transcripts.bam
